version: '2.1'

orbs:
  heroku: circleci/heroku@2.0.0
  java-maven: whoop/java-maven@1.0.12
  
# workflows:
#   sample_flow:
#     jobs:
#       - maven-deploy/code-checkout:
#           executor-version: 14-buster
#       - maven-deploy/resolve-dependency:
#           executor-version: 14-buster
#           requires:
#             - maven-deploy/code-checkout
#       - maven-deploy/build:
#           executor-version: 14-buster
#           requires:
#             - maven-deploy/resolve-dependency
#       - maven-deploy/test:
#           executor-version: 14-buster
#           requires:
#             - maven-deploy/build
#           result-path: target/surefire-reports
#       - maven-deploy/deploy:
#           deploy-command: >-
#             mvn deploy --settings .circleci/settings.xml -DskipTests
#             -Dcheckstyle.skip -B -Prelease
#           executor-version: 14-buster
#           filters:
#             branches:
#               only:
#                 - main    

jobs:
  deploy:
    executor: heroku/default
    steps:
      - heroku/install
      - run: heroku login
      - heroku/deploy-via-git
  build:
    executor: java-maven/default
    steps:
      - checkout
      - java-maven/resolve-dependencies
      - java-maven/build-and-test


workflows:
  deploy:
    jobs:
      - build
      - deploy 